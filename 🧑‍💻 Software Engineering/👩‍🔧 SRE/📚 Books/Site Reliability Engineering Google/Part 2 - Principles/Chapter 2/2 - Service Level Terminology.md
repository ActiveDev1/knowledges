**اصطلاحات سطح سرویس**

بسیاری از خوانندگان احتمالاً با مفهوم **SLA** آشنا هستند، اما اصطلاحات **SLI** و **SLO** نیز نیاز به تعریف دقیق دارند، زیرا در استفاده روزمره، **SLA** معانی مختلفی بسته به زمینه پیدا کرده است. برای وضوح، این معانی را از هم جدا می‌کنیم.

### شاخص‌های سطح سرویس (SLI)
**SLI** (Service Level Indicator) یک معیار کمی و دقیق است که جنبه‌ای از سطح سرویس ارائه‌شده را اندازه‌گیری می‌کند. 
- **مثال‌های رایج SLI**:
  - **Request Latency**: مدت‌زمان پاسخ به یک درخواست (مثلاً میلی‌ثانیه).
  - **Error Rate**: کسری از درخواست‌هایی که با خطا مواجه می‌شوند.
  - **Throughput**: تعداد درخواست‌های پردازش‌شده در ثانیه.
- این معیارها معمولاً در یک بازه زمانی (**measurement window**) جمع‌آوری شده و به صورت نرخ، میانگین یا صدک (**percentile**) گزارش می‌شوند.
- **ایده‌آل**: SLI باید مستقیماً سطح سرویس موردنظر را اندازه‌گیری کند، اما گاهی به دلیل دشواری در اندازه‌گیری یا تفسیر، از یک **proxy** استفاده می‌شود. مثلاً، **client-side latency** برای کاربر مهم‌تر است، اما ممکن است فقط **server-side latency** قابل اندازه‌گیری باشد.
- **SLI‌های مهم برای SRE**:
  - **Availability**: کسری از زمان که سرویس قابل استفاده است، اغلب به صورت **yield** (درصد درخواست‌های موفق) تعریف می‌شود.
  - **Durability**: احتمال حفظ داده‌ها در طولانی‌مدت (برای سیستم‌های ذخیره‌سازی).
- **Availability** معمولاً با تعداد "nines" بیان می‌شود (مثل 99% = "2 nines"، 99.999% = "5 nines"). مثلاً، هدف **Google Compute Engine**، 99.95% **availability** ("سه و نیم nine") است.

### اهداف سطح سرویس (SLO)
**SLO** (Service Level Objective) یک مقدار هدف یا محدوده‌ای از مقادیر برای سطح سرویسی است که توسط **SLI** اندازه‌گیری می‌شود. ساختار طبیعی SLO به صورت **SLI ≤ target** یا **lower bound ≤ SLI ≤ upper bound** است.
- **مثال**: برای یک سرویس جست‌وجوی شکسپیر، ممکن است SLO این باشد: "میانگین **latency** درخواست‌های جست‌وجو باید کمتر از 100 میلی‌ثانیه باشد."
- **چالش انتخاب SLO**:
  - همیشه نمی‌توان مقدار آن را آزادانه انتخاب کرد. مثلاً، **QPS** (تعداد درخواست‌ها در ثانیه) به رفتار کاربران بستگی دارد و نمی‌توان برای آن SLO تعیین کرد.
  - اما می‌توان برای **latency** هدف تعیین کرد (مثلاً زیر 100 میلی‌ثانیه)، که ممکن است به طراحی سیستم با رفتارهای کم‌تأخیر یا خرید تجهیزات خاص منجر شود.
  - **latency** و **QPS** ممکن است به هم مرتبط باشند: QPS بالاتر اغلب به **latency** بیشتر منجر می‌شود، و سرویس‌ها ممکن است در بارهای بالا دچار **performance cliff** شوند.
- **اهمیت SLO**: تعیین و اعلام SLO به کاربران، انتظارات را درباره عملکرد سرویس مشخص می‌کند. این کار از شکایات بی‌اساس (مثل کندی سرویس) جلوگیری می‌کند. بدون SLO، کاربران ممکن است انتظارات غیرواقعی داشته باشند، که منجر به **over-reliance** (اعتماد بیش‌ازحد به سرویس) یا **under-reliance** (عدم اعتماد به سرویس پایدار) می‌شود.

**مثال: قطعی برنامه‌ریزی‌شده Chubby**
- **Chubby** یک سرویس قفل توزیع‌شده گوگل است که نمونه‌های آن در مناطق جغرافیایی مختلف قرار دارند. در گذشته، قطعی‌های **global Chubby** باعث **outage**های قابل‌توجه برای کاربران می‌شد. چون **Chubby** بسیار قابل‌اعتماد بود، تیم‌های سرویس به اشتباه فرض می‌کردند که هرگز قطع نمی‌شود و وابستگی‌های غیرمنطقی به آن ایجاد کردند.
- **راه‌حل SRE**: اطمینان از اینکه **Chubby** از **SLO** خود فراتر نمی‌رود. اگر در یک فصل قطعی واقعی رخ ندهد که **availability** را زیر هدف بیاورد، SRE یک **outage کنترل‌شده** ایجاد می‌کند تا وابستگی‌های غیرمنطقی شناسایی و رفع شوند. این کار تیم‌ها را وادار می‌کند تا واقعیت سیستم‌های توزیع‌شده را زودتر بپذیرند.

### توافق‌نامه‌های سطح سرویس (SLA)
**SLA** (Service Level Agreement) یک قرارداد صریح یا ضمنی با کاربران است که شامل **SLO**ها و پیامدهای دستیابی (یا عدم دستیابی) به آن‌ها می‌شود. 
- **پیامدها**: معمولاً مالی هستند (مثل تخفیف یا جریمه)، اما می‌توانند شکل دیگری داشته باشند.
- **تفاوت SLO و SLA**: اگر عدم دستیابی به SLO پیامد مشخصی نداشته باشد، معمولاً فقط یک SLO است.
- تیم SRE معمولاً در ساخت **SLA** دخیل نیست، زیرا SLA به تصمیمات کسب‌وکاری و محصول مرتبط است. اما SRE در تعریف **SLI**ها (برای اندازه‌گیری عینی SLOها) و جلوگیری از نقض SLOها نقش دارد.

**مثال**:
- **Google Search**: SLA عمومی ندارد، زیرا هدف آن استفاده روان و کارآمد برای همه است. اما قطعی‌ها می‌توانند به اعتبار گوگل یا درآمد تبلیغاتی آسیب بزنند.
- **Google for Work**: SLA صریح با کاربران دارد که پیامدهای نقض SLOها (مثل جریمه) را مشخص می‌کند.

تعریف **SLI** و **SLO** برای هر سرویسی (چه با SLA یا بدون آن) ارزشمند است، زیرا به مدیریت بهتر سرویس کمک می‌کند.