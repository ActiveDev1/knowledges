**انگیزه برای Error Budget**

تفاوت در معیارهای ارزیابی تیم‌های توسعه محصول و SRE می‌تواند باعث تنش شود. عملکرد تیم توسعه معمولاً بر اساس **product velocity** (سرعت ارائه محصول) سنجیده می‌شود، که انگیزه‌ای برای **push** سریع کدهای جدید ایجاد می‌کند. در مقابل، عملکرد SRE بر اساس **reliability** سرویس ارزیابی می‌شود، که انگیزه‌ای برای مقاومت در برابر تغییرات سریع به وجود می‌آورد. **اطلاعات نامتقارن** بین این دو تیم این تنش را تشدید می‌کند: توسعه‌دهندگان به زمان و تلاش لازم برای کدنویسی و release آگاه‌ترند، در حالی که SREها دید بهتری به **reliability** سرویس و وضعیت **production** دارند.

این تنش‌ها اغلب در اختلاف‌نظر درباره میزان تلاش برای روش‌های مهندسی ظاهر می‌شوند:
- **Software Fault Tolerance**: نرم‌افزار تا چه حد باید در برابر حوادث غیرمنتظره مقاوم باشد؟ مقاومت کم باعث محصول شکننده و مقاومت زیاد باعث محصولی غیرجذاب می‌شود.
- **Testing**: تست ناکافی منجر به **outage**های شرم‌آور یا نشت داده‌ها می‌شود، اما تست بیش‌ازحد ممکن است بازار را از دست بدهید.
- **Push Frequency**: هر **push** ریسک دارد. چقدر باید روی کاهش این ریسک تمرکز کنیم؟
- **Canary Duration and Size**: تست release جدید روی زیرمجموعه‌ای کوچک (**canarying**) چقدر طول بکشد و چه اندازه باشد؟

تیم‌ها معمولاً تعادل غیررسمی‌ای برای این ریسک‌ها پیدا می‌کنند، اما این تعادل ممکن است بهینه نباشد و به مهارت مذاکره یا سیاست وابسته باشد. هدف ما تعریف یک **metric عینی** است که مورد توافق هر دو طرف باشد و مذاکرات را به‌صورت داده‌محور هدایت کند. شعار غیررسمی SRE گوگل این است: "امید استراتژی نیست."

### تشکیل Error Budget
برای تصمیم‌گیری داده‌محور، تیم‌ها با هم یک **error budget** فصلی بر اساس **SLO** (Service Level Objective) سرویس تعریف می‌کنند. **Error budget** یک معیار واضح است که نشان می‌دهد سرویس در یک فصل تا چه حد می‌تواند **unreliable** باشد. این معیار سیاست را از مذاکرات بین SRE و توسعه‌دهندگان حذف می‌کند.

روند کار به این صورت است:
- **Product Management** یک **SLO** تعریف می‌کند که سطح **uptime** مورد انتظار سرویس را مشخص می‌کند.
- **Uptime واقعی** توسط یک طرف بی‌طرف (سیستم **monitoring**) اندازه‌گیری می‌شود.
- تفاوت بین این دو عدد، **error budget** یا میزان مجاز **unreliability** در فصل است.
- تا زمانی که **uptime** بالاتر از **SLO** باشد (یعنی **error budget** باقی مانده باشد)، releaseهای جدید می‌توانند **push** شوند.

**مثال**: اگر **SLO** سرویسی 99.999% **availability** در یک فصل باشد، **error budget** برابر با 0.001% نرخ شکست است. اگر مشکلی باعث شکست 0.0002% درخواست‌ها شود، 20% از **error budget** فصلی مصرف شده است.

### مزایا
**Error budget** انگیزه مشترکی ایجاد می‌کند که به تیم‌های توسعه و SRE اجازه می‌دهد تعادل مناسبی بین نوآوری و **reliability** پیدا کنند:
- اگر **SLO** سرویس رعایت شود، releaseها ادامه می‌یابد.
- اگر نقض **SLO** مکرر باشد و **error budget** تمام شود، releaseها موقتاً متوقف می‌شوند و منابع برای بهبود **resilience**، **performance** یا تست سیستم صرف می‌شود.
- روش‌های ظریف‌تر مثل کاهش سرعت release یا **rollback** در صورت نزدیک شدن به پایان **error budget** نیز ممکن است.

**مثال**: اگر تیم توسعه بخواهد تست را کاهش دهد یا **push velocity** را افزایش دهد و SRE مقاومت کند، **error budget** تصمیم را هدایت می‌کند. وقتی بودجه زیاد است، توسعه‌دهندگان می‌توانند ریسک بیشتری کنند. وقتی بودجه رو به اتمام است، خودشان برای تست بیشتر یا کاهش سرعت **push** فشار می‌آورند تا از توقف لانچ جلوگیری کنند. این باعث می‌شود تیم توسعه خودکنترل شود.

اگر **outage** ناشی از مشکل شبکه یا خرابی دیتاسنتر رخ دهد، این هم از **error budget** مصرف می‌کند و ممکن است تعداد **push**های جدید در بقیه فصل کاهش یابد. همه تیم این کاهش را حمایت می‌کنند، زیرا مسئولیت **uptime** مشترک است.

**Error budget** همچنین هزینه‌های اهداف **reliability** بیش‌ازحد بالا را نشان می‌دهد (مثل کاهش انعطاف‌پذیری و کندی نوآوری). اگر لانچ ویژگی‌های جدید سخت باشد، تیم ممکن است **SLO** را کاهش دهد تا **error budget** بیشتری برای نوآوری داشته باشد.

### نکات کلیدی
- مدیریت **reliability** سرویس یعنی مدیریت ریسک، و این می‌تواند پرهزینه باشد.
- 100% **reliability** معمولاً هدف درستی نیست، زیرا غیرممکن است و کاربران تفاوت آن با 99.999% را متوجه نمی‌شوند. **Reliability** باید با ریسک کسب‌وکار هماهنگ باشد.
- **Error budget** انگیزه‌ها را هم‌راستا می‌کند و مالکیت مشترک بین SRE و توسعه را تقویت می‌کند. این روش تصمیم‌گیری درباره سرعت releaseها را آسان‌تر کرده، بحث‌های مربوط به **outage**ها را با ذی‌نفعان خنثی می‌کند و به تیم‌ها اجازه می‌دهد بدون تنش به نتیجه مشترکی درباره ریسک **production** برسند.